require('dotenv').config({path: __dirname + '/.env'})

http = require('http')

const port = 3001;

function generateStringBySize(bytes) {
  let myHugeString = '';
  for (let i = 0; i < bytes; i++) {
    myHugeString += 'a';
  }
  return myHugeString;
}
console.log(`Listening on port ${port}... \n
              content size=${process.env.CONTENT_SIZE}`)

http.createServer(function (req, res) {
  const size = Number(process.env.CONTENT_SIZE) - 14;
  const jsonResp = JSON.stringify({content: generateStringBySize(size)});

  res.writeHead(200, {'Content-Type': 'text/plain'});
  res.write(jsonResp);
  console.log(`Recebi uma chamada, devolvendo string de tamanho: ${jsonResp.length}`)
  res.end();
}).listen(port);
